(this["webpackJsonpsocial-app"]=this["webpackJsonpsocial-app"]||[]).push([[0],{271:function(e,t,a){e.exports=a(498)},276:function(e,t,a){},490:function(e,t,a){},498:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),o=a.n(c),s=a(10),l=a(21),i=(a(276),a(7)),u=a.n(i),m=a(37),d=a(9),f=a(39),p=a.n(f),b=a(118),E=a.n(b),g=r.a.createContext(null),h=function(e){return function(t){return r.a.createElement(g.Consumer,null,(function(a){return r.a.createElement(e,Object.assign({},t,{firebase:a}))}))}},v=g,O=a(5),N=a(11),y=function(e,t){switch(t.type){case"SET_POSTS":return Object(N.a)(Object(N.a)({},e),{},{data:Object(N.a)(Object(N.a)({},e.data),{},{post:{},posts:t.payload})});case"SET_POST":return Object(N.a)(Object(N.a)({},e),{},{data:Object(N.a)(Object(N.a)({},e.data),{},{post:t.payload})});case"SET_USER":return Object(N.a)(Object(N.a)({},e),{},{user:Object(N.a)(Object(N.a)({},e.user),{},{authenticated:!0,credentials:Object(N.a)({},t.payload),loading:!1})});case"SET_NOTIFICATION":return Object(N.a)(Object(N.a)({},e),{},{user:Object(N.a)(Object(N.a)({},e.user),{},{notifications:t.payload})});case"LOGOUT_USER":return Object(N.a)(Object(N.a)({},e),{},{data:{posts:[],post:Object(N.a)({},e.data.post)},user:{authenticated:!1,credentials:{},notifications:[],likes:[]}});case"LIKE_POST":return Object(N.a)(Object(N.a)({},e),{},{user:Object(N.a)(Object(N.a)({},e.user),{},{likes:Object(m.a)(t.payload)})});default:return e}},j={data:{posts:[],post:{}},user:{authenticated:!1,credentials:{},likes:[],notifications:[],loading:!0},ui:{loading:!1,errors:null}},w=Object(n.createContext)(j),x=h((function(e){var t=e.firebase,a=e.children,c=Object(n.useReducer)(y,j),o=Object(O.a)(c,2),s=o[0],l=o[1];Object(n.useEffect)((function(){var e;t.auth.onAuthStateChanged((function(a){a?function(){var a=Object(d.a)(u.a.mark((function a(n){return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.firestore.collection("users").where("userId","==",n).get();case 2:a.sent.forEach((function(a){e=t.firestore.collection("notifications").where("recipient","==",a.data().userName).orderBy("createdAt","desc").onSnapshot((function(e){if(e.empty)l({type:"SET_NOTIFICATION",payload:null});else{var t=[];e.forEach((function(e){var a=e.data();a.id=e.id,t.push(a)})),l({type:"SET_NOTIFICATION",payload:t})}})),l({type:"SET_USER",payload:a.data()})}));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()(a.uid):("function"===typeof e&&e(),l({type:"LOGOUT_USER"}))}))}),[]);return r.a.createElement(w.Provider,{value:{state:s,setPosts:function(e){l({type:"SET_POSTS",payload:e})},setLikes:function(e){l({type:"LIKE_POST",payload:e})},setPost:function(e){l({type:"SET_POST",payload:e})}}},a)})),I=a(182),k=a(534),C=a(540),S=a(551),F=a(539),U=a(537),L=a(548),P=a(553),R=a(549),T=a(257),A=h((function(e){var t=e.firebase,a=e.commentCount,c=e.postId,o=e.userName,s=e.userImage,l=e.displayedName,i=Object(n.useState)(!1),m=Object(O.a)(i,2),f=m[0],p=m[1],b=Object(n.useState)(""),E=Object(O.a)(b,2),g=E[0],h=E[1],v=Object(n.useState)(!1),N=Object(O.a)(v,2),y=N[0],j=N[1],w=function(){h(""),p(!1)},x=function(){var e=Object(d.a)(u.a.mark((function e(){var a,n,r,i,m;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),a=t.firestore.collection("posts").doc(c),e.next=4,a.get();case 4:return n=e.sent,r=n.data().userName,e.next=8,t.firestore.collection("comments").add({body:g,createdAt:(new Date).toISOString(),postId:c,userName:o,userImage:s,displayedName:l,postImg:[]});case 8:return i=e.sent,m=i.id,e.next=12,a.update({commentCount:t.FieldValue.increment(1)});case 12:if(o===r){e.next=15;break}return e.next=15,t.firestore.collection("notifications").doc(m).set({createdAt:(new Date).toISOString(),postId:c,read:!1,recipient:r,sender:o,type:"comment"});case 15:j(!1),w();case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"comment-button-container",onClick:function(){p(!0)}},r.a.createElement(k.a,{"aria-label":"like",size:"small"},r.a.createElement(T.a,null,r.a.createElement("path",{d:"M14.046 2.242l-4.148-.01h-.002c-4.374 0-7.8 3.427-7.8 7.802 0 4.098 3.186 7.206 7.465 7.37v3.828c0 .108.044.286.12.403.142.225.384.347.632.347.138 0 .277-.038.402-.118.264-.168 6.473-4.14 8.088-5.506 1.902-1.61 3.04-3.97 3.043-6.312v-.017c-.006-4.367-3.43-7.787-7.8-7.788zm3.787 12.972c-1.134.96-4.862 3.405-6.772 4.643V16.67c0-.414-.335-.75-.75-.75h-.396c-3.66 0-6.318-2.476-6.318-5.886 0-3.534 2.768-6.302 6.3-6.302l4.147.01h.002c3.532 0 6.3 2.766 6.302 6.296-.003 1.91-.942 3.844-2.514 5.176z"}))),a>0?r.a.createElement(I.a,{variant:"body1",component:"span"},a):null),r.a.createElement(S.a,{open:f,onClose:w,className:"add-reply dialogbox ".concat(y?"uploading-reply":""),fullWidth:!0},r.a.createElement(U.a,null,r.a.createElement(R.a,{display:"flex",alignItems:"center"},r.a.createElement(P.a,{alt:o,src:s,className:"avatar"}),r.a.createElement(L.a,{type:"text",placeholder:"Post your reply",onChange:function(e){return h(e.target.value)},value:g,multiline:!0,className:"text-field"}))),r.a.createElement(F.a,null,y?null:r.a.createElement(C.a,{className:"submit-button",disabled:!g&&!0,onClick:x},"Reply"))))})),D=a(123),z=a.n(D),M=a(235),_=a.n(M),B=h((function(e){var t=e.firebase,a=e.postId,c=e.userName,o=e.likeCount,s=Object(n.useContext)(w),l=s.state,i=s.setLikes,m=l.user.likes;Object(n.useEffect)((function(){(function(){var e=Object(d.a)(u.a.mark((function e(){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.firestore.collection("likes").get();case 2:a=e.sent,n=[],a.forEach((function(e){n.push(e.data())})),i(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[o]);var f=function(){var e=Object(d.a)(u.a.mark((function e(a){var n,r,o,s,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.firestore.collection("posts").doc(a),e.next=3,n.get();case 3:return r=e.sent,o=r.data().userName,e.next=7,t.firestore.collection("likes").add({postId:a,userName:c});case 7:return s=e.sent,l=s.id,e.next=11,n.update({likeCount:t.FieldValue.increment(1)});case 11:if(c===o){e.next=14;break}return e.next=14,t.firestore.collection("notifications").doc(l).set({createdAt:(new Date).toISOString(),postId:a,read:!1,recipient:o,sender:c,type:"like"});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(d.a)(u.a.mark((function e(a){var n,r,o,s,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.firestore.collection("posts").doc(a),e.next=3,n.get();case 3:return r=e.sent,o=r.data().userName,e.next=7,t.firestore.collection("likes").where("userName","==",c).where("postId","==",a).limit(1).get();case 7:return s=e.sent,l=s.docs[0].id,e.next=11,t.firestore.collection("likes").doc("".concat(l)).delete();case 11:return e.next=13,n.update({likeCount:t.FieldValue.increment(-1)});case 13:if(c===o){e.next=16;break}return e.next=16,t.firestore.collection("notifications").doc(l).delete();case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,m&&m.find((function(e){return e.postId===a&&e.userName===c}))?r.a.createElement("div",{className:"like-button-container liked-post",onClick:function(){return p(a)}},r.a.createElement(k.a,{"aria-label":"like",size:"small"},r.a.createElement(z.a,null)),o>0?r.a.createElement(I.a,{variant:"body2",component:"span",className:"like-count"},o):null):r.a.createElement("div",{className:"like-button-container",onClick:function(){return f(a)}},r.a.createElement(k.a,{"aria-label":"like",size:"small"},r.a.createElement(_.a,null)),o>0?r.a.createElement(I.a,{variant:"body2",component:"span",className:"like-count"},o):null))})),G=a(254),V=a(124),W=a(237),K=a.n(W),Y=a(238),J=a.n(Y),H=function(e){var t=e.body,a=e.postImg,n=e.gif;return r.a.createElement(R.a,{className:"post-body"},t?r.a.createElement(J.a,{componentDecorator:function(e,t,a){return r.a.createElement("a",{href:e,key:a,target:"_blank",rel:"noopener noreferrer",className:"post-link"},t)}},r.a.createElement(K.a,{options:{className:"twemoji"},noWrapper:!0},r.a.createElement(I.a,{variant:"body1"},t))):null,a.length>0?r.a.createElement("div",{className:"post-img-container"},a.map((function(e,t){return r.a.createElement("div",{className:"post-img",key:t,style:{backgroundImage:"url(".concat(e,")")}},r.a.createElement(G.a,{hideDownload:!0,hideZoom:!0,small:e,large:e}))}))):null,n?r.a.createElement(V.Gif,{gif:n,width:500,onGifClick:function(e,t){t.preventDefault(),window.open(e.url,"_blank")}}):null)},q=a(541),Z=a(542),Q=a(129),X=a.n(Q),$=h((function(e){var t=e.firebase,a=e.postId,c=Object(n.useState)(!1),o=Object(O.a)(c,2),s=o[0],l=o[1],i=t.firestore,m=function(){l(!1)},f=function(){var e=Object(d.a)(u.a.mark((function e(){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.collection("posts").doc(a).get();case 2:return(n=e.sent).exists&&n.data().postImg.map((function(e){return t.storage.refFromURL(e).delete()})),e.next=6,i.collection("likes").where("postId","==",a).get();case 6:return(r=e.sent).exists&&r.forEach((function(e){e.ref.delete()})),e.next=10,i.collection("comments").where("postId","==",a).get();case 10:return(c=e.sent).exists&&c.forEach((function(e){e.ref.delete()})),e.next=14,i.collection("posts").doc(a).delete();case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{onClick:function(){l(!0)},startIcon:r.a.createElement(X.a,null)},"Delete"),r.a.createElement(S.a,{open:s,onClose:m,className:"dialogbox",maxWidth:"xs"},r.a.createElement(q.a,null,"Delete post?"),r.a.createElement(U.a,null,r.a.createElement(Z.a,null,"This can\u2019t be undone and it will be removed from your profile, the timeline of any accounts that follow you, and from search results.")),r.a.createElement(F.a,{className:"delete-action"},r.a.createElement(C.a,{onClick:m,className:"btn cancel"},"cancel"),r.a.createElement(C.a,{onClick:f,className:"btn delete"},"Delete"))))})),ee=a(255),te=a(555),ae=a(130),ne=a.n(ae),re=function(e){var t=e.postId,a=e.postUsername,c=Object(n.useContext)(w).state.user,o=c.credentials.userName,s=c.authenticated,l=Object(n.useState)(!1),i=Object(O.a)(l,2),u=i[0],m=i[1],d=Object(n.useState)(null),f=Object(O.a)(d,2),p=f[0],b=f[1];return r.a.createElement(r.a.Fragment,null,s&&a===o?r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{onClick:function(e){!function(e,t){m(t),b(e.target)}(e,t)},className:"post-toggle-menu",size:"small"},r.a.createElement(ne.a,null)),r.a.createElement(ee.a,{className:"menu-toggled",anchorEl:p,open:u===t,onClose:function(){m(null),b(!1)}},r.a.createElement(te.a,{className:"menu-item menu-item-delete"},r.a.createElement($,{postId:t})))):null)},ce=function(e){var t=e.userName,a=e.userImage;return r.a.createElement(R.a,{mr:2,className:"user-info"},r.a.createElement(s.b,{to:"/user/".concat(t)},r.a.createElement(P.a,{alt:t,src:a,className:"avatar"})))},oe=a(543),se=h((function(e){var t=e.firebase,a=e.singleUserPosts,c=Object(n.useContext)(w),o=c.state,l=c.setPosts,i=t.firestore,f=o.data.posts,b=o.user.credentials,g=b.userName,h=b.userImage,v=b.displayedName;return p.a.extend(E.a),Object(n.useEffect)((function(){if(a){var e=i.collection("posts").where("userName","==",a).orderBy("createdAt","desc").onSnapshot((function(e){var t=[];e.forEach((function(e){var a=e.data();a.id=e.id,t.push(a)})),l(t)}));return function(){l([]),e()}}}),[a]),Object(n.useEffect)((function(){if(g&&!a){var e,t=[g];return function(){var a=Object(d.a)(u.a.mark((function a(){var n;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.collection("following").doc(g).get();case 2:(n=a.sent).exists&&(t=[].concat(Object(m.a)(t),Object(m.a)(n.data().listFollowing))),e=i.collection("posts").where("userName","in",t).orderBy("createdAt","desc").onSnapshot((function(e){var t=[];e.forEach((function(e){var a=e.data();a.id=e.id,t.push(a)})),l(t)}));case 5:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()(),function(){l([]),"function"===typeof e&&e()}}}),[g]),r.a.createElement(r.a.Fragment,null,f&&f.length>0?r.a.createElement(r.a.Fragment,null,f.map((function(e){return r.a.createElement(R.a,{width:1,display:"flex",alignItems:"flex-start",className:"post-info",key:e.id},r.a.createElement(s.b,{className:"post-global-link",to:"/".concat(g,"/post/").concat(e.id)}),r.a.createElement(ce,{userImage:e.userImage,userName:e.userName}),r.a.createElement(R.a,{width:1},r.a.createElement(R.a,{display:"flex",alignItems:"baseline"},r.a.createElement(s.b,{to:"/user/".concat(e.userName),className:"post-user-link"},r.a.createElement(I.a,{variant:"h6",component:"span",className:"post-displayed-name"},e.displayedName),r.a.createElement(I.a,{variant:"body2",component:"span",className:"post-username"},"@",e.userName," ",r.a.createElement("span",{className:"spacer"}," \xb7 "))),r.a.createElement(I.a,{variant:"body2",component:"p",className:"post-date"},p()(e.createdAt).fromNow(!0)),r.a.createElement(re,{postUsername:e.userName,postId:e.id})),r.a.createElement(H,{body:e.body,postImg:e.postImg,gif:e.gif}),r.a.createElement(R.a,{display:"flex",alignItems:"center",className:"post-actions"},r.a.createElement(A,{displayedName:v,commentCount:e.commentCount,postId:e.id,userName:g,userImage:h}),r.a.createElement(B,{postId:e.id,userName:g,likeCount:e.likeCount}))))}))):r.a.createElement(R.a,{display:"flex",justifyContent:"center"},r.a.createElement(oe.a,{size:30})))})),le=a(203),ie=a(239),ue=a.n(ie),me=function(e){var t=e.chosenGif,a=e.handleUploadFile,n=e.multiple;return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{accept:"image/jpeg,image/png,image/webp,image/gif,video/mp4,video/quicktime,video/webm",hidden:!0,id:"icon-button-file",multiple:n,type:"file",onChange:a,disabled:null!==t}),r.a.createElement("label",{htmlFor:"icon-button-file"},r.a.createElement(k.a,{className:"upload-img","aria-label":"upload image",component:"span",disabled:null!==t},r.a.createElement(ue.a,null))))},de=a(66),fe=a.n(de),pe=function(e){var t=e.uploadedImg,a=e.setUploadedImg;return r.a.createElement("div",{className:"preview-img-container"},t.map((function(e,n){return r.a.createElement("div",{className:"preview-img",key:n,style:{backgroundImage:"url(".concat(URL.createObjectURL(e),")")}},r.a.createElement(k.a,{className:"delete-img-post",onClick:function(){return function(e){var n=Object(m.a)(t),r=n.indexOf(e);return r>-1&&n.splice(r,1),a(n)}(e)},"aria-label":"delete picture",component:"button"},r.a.createElement(fe.a,null)),r.a.createElement("img",{src:URL.createObjectURL(e),alt:""}))})))},be=(a(393),a(253)),Ee=a(538),ge=a(240),he=a.n(ge),ve=function(e){var t=e.setChosenEmoji,a=Object(n.useState)(null),c=Object(O.a)(a,2),o=c[0],s=c[1],l=Boolean(o),i=l?"add-emoji":void 0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{"aria-describedby":i,onClick:function(e){s(e.currentTarget)},className:"add-smiley"},r.a.createElement(he.a,null)),r.a.createElement(Ee.a,{id:i,open:l,anchorEl:o,onClose:function(){s(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"left"}},r.a.createElement(be.a,{set:"twitter",onSelect:function(e){t(e.native)},theme:"dark",title:"",emoji:""})))},Oe=a(252),Ne=a(242),ye=a.n(Ne),je=function(e){var t=e.uploadedImg,a=e.setChosenGif,c=Object(n.useState)(null),o=Object(O.a)(c,2),s=o[0],l=o[1],i=function(){l(null)},u=Boolean(s),m=u?"add-gif":void 0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{"aria-describedby":m,onClick:function(e){l(e.currentTarget)},className:"add-gif-button",disabled:t.length>0},r.a.createElement(ye.a,null)),r.a.createElement(Ee.a,{id:m,open:u,anchorEl:s,onClose:i},r.a.createElement(Oe.a,{apiKey:"Y2EGJx2RDFT6NEdyPzB4Yv0nz7Nd1J7B",onSelect:function(e){a(e),i()},poweredByGiphy:!1,imageBackgroundColor:"#15202b",searchFormClassName:"search-gif",wrapperClassName:"add-gif-wrapper",masonryConfig:[{columns:3,imageWidth:200,gutter:6}],listWrapperClassName:"list-gif-wrapper",gifListHeight:600})))},we=function(e){var t=e.setChosenGif,a=e.chosenGif;return r.a.createElement("div",{className:"preview-gif-container"},r.a.createElement("div",{className:"preview-gif"},r.a.createElement(k.a,{className:"delete-gif-post",onClick:function(){return t(null)},component:"button"},r.a.createElement(fe.a,null)),r.a.createElement(V.Gif,{gif:a,width:500})))},xe=a(552),Ie=a(550),ke=function(e){var t=e.tooManyFiles,a=e.setTooManyFiles,n=function(e,t){"clickaway"!==t&&a(!1)},c=function(e){return r.a.createElement(Ie.a,Object.assign({elevation:6,variant:"filled"},e))};return r.a.createElement(xe.a,{open:t,autoHideDuration:6e3,onClose:n},r.a.createElement(c,{onClose:n,severity:"error"},"No more than 4 photos"))},Ce=h((function(e){var t=e.firebase,a=Object(n.useContext)(w).state,c=t.firestore,o=a.user.credentials,s=o.userName,l=o.userImage,i=o.displayedName,f=Object(n.useState)(""),p=Object(O.a)(f,2),b=p[0],E=p[1],g=Object(n.useState)(0),h=Object(O.a)(g,2),v=h[0],N=h[1],y=Object(n.useState)([]),j=Object(O.a)(y,2),x=j[0],I=j[1],k=Object(n.useState)(!1),S=Object(O.a)(k,2),F=S[0],U=S[1],T=Object(n.useState)(!1),A=Object(O.a)(T,2),D=A[0],z=A[1],M=Object(n.useState)(null),_=Object(O.a)(M,2),B=_[0],G=_[1],V=Object(n.useState)(null),W=Object(O.a)(V,2),K=W[0],Y=W[1],J=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.collection("posts").add({body:b,commentCount:0,createdAt:(new Date).toISOString(),likeCount:0,userImage:l,userName:s,displayedName:i,postImg:t,gif:K});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){if(B){var e=b.substring(0,v),t=b.substring(v);E(v?e!==t?e+t+B:e+B:e+t+B),G(null)}}),[B]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ke,{tooManyFiles:D,setTooManyFiles:z}),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),""===b&&0===x.length&&null===K||(U(!0),Promise.all(x.map((function(e){var a=e.name.split(".").pop(),n="".concat(Object(le.a)(),".").concat(a);return t.storage.ref("".concat(s,"/").concat(n)).put(e)}))).then(function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=0;case 2:if(!(n<t.length)){e.next=10;break}return e.next=5,t[n].ref.getDownloadURL();case 5:r=e.sent,a.push(r);case 7:n++,e.next=2;break;case 10:J(a),E(""),I([]),U(!1),G(null),Y(null);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){U(!1),console.log(e)})))},className:"upload-post"+(F?" upload-post-loading":"")},r.a.createElement(R.a,{display:"flex",alignItems:"flex-start"},r.a.createElement(R.a,{mr:2},r.a.createElement(P.a,{alt:s,src:l,className:"avatar"})),r.a.createElement(R.a,{width:1},r.a.createElement(L.a,{type:"text",placeholder:"Post a message",onChange:function(e){return function(e){E(e.target.value),N(e.target.selectionStart)}(e)},onKeyUp:function(e){return function(e){37!==e.which&&38!==e.which&&39!==e.which&&40!==e.which||N(e.target.selectionStart)}(e)},onClick:function(e){return N(e.target.selectionStart)},value:b,multiline:!0,className:"text-field"}),x?r.a.createElement(pe,{uploadedImg:x,setUploadedImg:I}):null,K?r.a.createElement(we,{setChosenGif:Y,chosenGif:K}):null,r.a.createElement(R.a,{display:"flex",alignItems:"center",justifyContent:"space-between"},r.a.createElement(R.a,{display:"flex",alignItems:"center",justifyContent:"space-between"},r.a.createElement(me,{chosenGif:K,handleUploadFile:function(e){var t=e.target.files,a=[];if(x.length>=4||t.length>4)return z(!0);for(var n=0;n<t.length;n++)a.push(e.target.files[n]);I((function(e){return[].concat(Object(m.a)(e),a)}))},multiple:!0}),r.a.createElement(ve,{setChosenEmoji:G}),r.a.createElement(je,{uploadedImg:x,setChosenGif:Y})),r.a.createElement(C.a,{disabled:""===b&&0===x.length&&null===K,type:"submit",variant:"contained",className:"submit-button"},"Post"))))))})),Se=r.a.createContext(null),Fe=function(e){return h((function(t){var a=Object(n.useState)(null),c=Object(O.a)(a,2),o=c[0],s=c[1];return Object(n.useEffect)((function(){var e=t.firebase.auth.onAuthStateChanged((function(e){s(e||null)}));return function(){e()}}),[t.firebase.auth]),r.a.createElement(Se.Provider,{value:o},r.a.createElement(e,t))}))},Ue=a(131),Le=function(e){return function(t){return Object(Ue.compose)(l.g,h)((function(a){return Object(n.useEffect)((function(){var t=a.firebase.auth.onAuthStateChanged((function(t){e(t)||a.history.push("/signin")}));return function(){t()}}),[]),r.a.createElement(Se.Consumer,null,(function(n){return e(n)?r.a.createElement(t,a):null}))}))}},Pe=Le((function(e){return!!e}))((function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce,null),r.a.createElement(se,null))})),Re=h((function(e){var t=e.firebase,a=e.commentId,c=e.postId,o=Object(n.useState)(!1),s=Object(O.a)(o,2),l=s[0],i=s[1],m=t.firestore,f=function(){i(!1)},p=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.collection("comments").doc(a).delete();case 2:return e.next=4,m.collection("posts").doc(c).update({commentCount:t.FieldValue.increment(-1)});case 4:return e.next=6,t.firestore.collection("notifications").doc(a).delete();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{onClick:function(){i(!0)},startIcon:r.a.createElement(X.a,null)},"Delete"),r.a.createElement(S.a,{open:l,onClose:f,className:"dialogbox",maxWidth:"xs"},r.a.createElement(q.a,null,"Delete post?"),r.a.createElement(U.a,null,r.a.createElement(Z.a,null,"This can\u2019t be undone and it will be removed from your profile, the timeline of any accounts that follow you, and from search results.")),r.a.createElement(F.a,{className:"delete-action"},r.a.createElement(C.a,{onClick:f,className:"btn cancel"},"cancel"),r.a.createElement(C.a,{onClick:p,className:"btn delete"},"Delete"))))})),Te=function(e){var t=e.commentId,a=e.commentUsername,c=e.postId,o=e.commentCount,s=Object(n.useContext)(w).state.user,l=s.credentials.userName,i=s.authenticated,u=Object(n.useState)(!1),m=Object(O.a)(u,2),d=m[0],f=m[1],p=Object(n.useState)(null),b=Object(O.a)(p,2),E=b[0],g=b[1];return r.a.createElement(r.a.Fragment,null,i&&a===l?r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{onClick:function(e){!function(e,t){f(t),g(e.target)}(e,t)},className:"post-toggle-menu",size:"small"},r.a.createElement(ne.a,null)),r.a.createElement(ee.a,{className:"menu-toggled",anchorEl:E,open:d===t,onClose:function(){f(null),g(!1)}},r.a.createElement(te.a,{className:"menu-item menu-item-delete"},r.a.createElement(Re,{commentId:t,postId:c,commentCount:o})))):null)},Ae=h((function(e){var t=e.firebase,a=e.postId,c=e.commentCount,o=e.postUsername,l=Object(n.useState)([]),i=Object(O.a)(l,2),u=i[0],m=i[1];return p.a.extend(E.a),Object(n.useEffect)((function(){var e=t.firestore.collection("comments").where("postId","==",a).onSnapshot((function(e){var t=[];e.forEach((function(e){var a=e.data();a.commentId=e.id,t.push(a)})),m(t)}));return function(){e()}}),[]),r.a.createElement(r.a.Fragment,null,u?u.map((function(e){return r.a.createElement(R.a,{width:1,display:"flex",alignItems:"flex-start",className:"post-info post-reply",key:e.commentId},r.a.createElement(ce,{userImage:e.userImage,userName:e.userName}),r.a.createElement(R.a,null,r.a.createElement(R.a,{display:"flex",alignItems:"center"},r.a.createElement(s.b,{to:"/user/".concat(e.userName)},r.a.createElement(I.a,{variant:"h6",component:"span",className:"post-displayed-name"},e.displayedName),r.a.createElement(I.a,{variant:"body2",component:"span",className:"post-username"},"@",e.userName," ",r.a.createElement("span",{className:"spacer"}," \xb7 "))),r.a.createElement(I.a,{variant:"body2",component:"p",className:"post-date"},p()(e.createdAt).fromNow(!0)),r.a.createElement(Te,{commentUsername:e.userName,postId:e.postId,commentId:e.commentId,commentCount:c})),r.a.createElement(I.a,{variant:"body2",component:"p",className:"post-reply-to"},"Replying to ",r.a.createElement(s.b,{to:"/user/".concat(o)},"@",o)),r.a.createElement(H,{body:e.body,postImg:e.postImg})))})):null)})),De=Object(l.g)(h((function(e){var t=e.firebase,a=e.postId,c=e.history,o=Object(n.useContext)(w),l=o.state,i=o.setPost,u=l.data.post,m=u.likeCount,d=u.commentCount,f=u.postImg,b=u.createdAt,E=u.userName,g=u.displayedName,h=u.body,v=u.userImage,O=u.gif;return Object(n.useEffect)((function(){var e=t.firestore.collection("posts").doc(a).onSnapshot((function(e){if(!e.exists)return c.push("/");i(e.data())}));return function(){e()}}),[]),r.a.createElement(r.a.Fragment,null,0!==Object.entries(l.data.post).length?r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{width:1,className:"post-info post-single",key:a},r.a.createElement(re,{postUsername:E,postId:a}),r.a.createElement(R.a,{className:"user-info",display:"flex",alignItems:"center"},r.a.createElement(s.b,{to:"/user/".concat(E)},r.a.createElement(P.a,{alt:E,src:v,className:"avatar"})),r.a.createElement(s.b,{to:"/user/".concat(E)},r.a.createElement(I.a,{variant:"h6",component:"span",className:"post-displayed-name"},g),r.a.createElement(I.a,{variant:"body2",component:"span",className:"post-username"},"@",E))),r.a.createElement(R.a,{width:1,mt:2},r.a.createElement(R.a,null,r.a.createElement(H,{body:h,postImg:f,gif:O})),r.a.createElement(R.a,null,r.a.createElement(I.a,{variant:"body2",component:"p",className:"post-date"},p()(b).format("H:mm A")," \xb7 ",p()(b).format("MMMM DD, YYYY"))),l.user.authenticated?r.a.createElement(R.a,{display:"flex",alignItems:"center",className:"post-actions"},r.a.createElement(A,{displayedName:l.user.credentials.displayedName,commentCount:d,postId:a,userName:l.user.credentials.userName,userImage:l.user.credentials.userImage}),r.a.createElement(B,{postId:a,userName:l.user.credentials.userName,likeCount:m})):null)),r.a.createElement(R.a,null,r.a.createElement(Ae,{postId:a,commentCount:d,postUsername:E}))):r.a.createElement(R.a,{width:1,display:"flex",justifyContent:"center"},r.a.createElement(oe.a,null)))}))),ze=Le((function(e){return!!e}))((function(e){var t=e.match.params.postId;return r.a.createElement(De,{postId:t})})),Me=a(132),_e=a.n(Me),Be=Object(l.g)((function(e){var t=e.firebase,a=e.userName,c=e.history,o=Object(n.useContext)(w).state,s=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.firestore.collection("users").where("userName","==",a).get();case 2:e.sent.forEach(function(){var e=Object(d.a)(u.a.mark((function e(a){var n,r,s,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(o.user.credentials.userId,"-").concat(a.data().userId),r="".concat(a.data().userId,"-").concat(o.user.credentials.userId),e.next=4,t.firestore.collection("rooms").where("roomKey","==",n).get();case 4:return s=e.sent,e.next=7,t.firestore.collection("rooms").where("roomKey","==",r).get();case 7:if(l=e.sent,s.empty&&l.empty){e.next=16;break}if(s.empty){e.next=13;break}return e.abrupt("return",c.push("".concat("/messages","/").concat(n)));case 13:return e.abrupt("return",c.push("".concat("/messages","/").concat(r)));case 14:e.next=19;break;case 16:return e.next=18,t.firestore.collection("rooms").add({availableUsers:[o.user.credentials.userId,a.data().userId],lastMessage:"",roomKey:n});case 18:return e.abrupt("return",c.push("".concat("/messages","/").concat(n)));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(k.a,{onClick:s,className:"profile-private-message-button"},r.a.createElement(_e.a,null))})),Ge=a(181),Ve=a.n(Ge),We=function(e){var t=e.firebase,a=e.open,c=e.handleClose,o=e.user,s=Object(n.useState)(""),l=Object(O.a)(s,2),i=l[0],m=l[1],f=Object(n.useState)(""),p=Object(O.a)(f,2),b=p[0],E=p[1],g=Object(n.useState)(""),h=Object(O.a)(g,2),v=h[0],N=h[1],y=Object(n.useState)(""),j=Object(O.a)(y,2),w=j[0],x=j[1],I=Object(n.useState)(""),P=Object(O.a)(I,2),R=P[0],T=P[1],A=Object(n.useState)(""),D=Object(O.a)(A,2),z=D[0],M=D[1],_=Object(n.useState)(""),B=Object(O.a)(_,2),G=B[0],V=B[1],W=Object(n.useState)(""),K=Object(O.a)(W,2),Y=K[0],J=K[1];Object(n.useEffect)((function(){m("".concat(o.displayedName)),E(o.bio),N(o.location),x(o.website),T(o.userImage),V(o.userBanner)}),[o]);var H=function(){var e=Object(d.a)(u.a.mark((function e(){var a,n,r,s,l,m,d,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.userImage,n=o.userBanner,!z){e.next=23;break}return e.next=5,t.storage.refFromURL(a);case 5:return e.sent.delete(),r=z.name.split(".").pop(),s="".concat(Object(le.a)(),".").concat(r),e.next=11,t.storage.ref("".concat(o.userName,"/").concat(s)).put(z);case 11:return l=e.sent,e.next=14,l.ref.getDownloadURL();case 14:return a=e.sent,e.next=17,t.firestore.collection("posts").where("userName","==",o.userName).get();case 17:return e.sent.forEach((function(e){e.ref.update({userImage:a})})),e.next=21,t.firestore.collection("comments").where("userName","==",o.userName).get();case 21:e.sent.forEach((function(e){e.ref.update({userImage:a})}));case 23:if(!Y){e.next=36;break}return e.next=26,t.storage.refFromURL(n);case 26:return e.sent.delete(),m=Y.name.split(".").pop(),d="".concat(Object(le.a)(),".").concat(m),e.next=32,t.storage.ref("".concat(o.userName,"/").concat(d)).put(Y);case 32:return f=e.sent,e.next=35,f.ref.getDownloadURL();case 35:n=e.sent;case 36:if(o.displayedName===i){e.next=45;break}return e.next=39,t.firestore.collection("posts").where("userName","==",o.userName).get();case 39:return e.sent.forEach((function(e){e.ref.update({displayedName:i,displayedName_lowercase:i.toLowerCase()})})),e.next=43,t.firestore.collection("comments").where("userName","==",o.userName).get();case 43:e.sent.forEach((function(e){e.ref.update({displayedName:i,displayedName_lowercase:i.toLowerCase()})}));case 45:return e.next=47,t.firestore.collection("users").doc(o.userName).update({bio:b,displayedName:i,displayedName_lowercase:i.toLowerCase(),location:v,website:w,userImage:a,userBanner:n});case 47:return e.abrupt("return",c());case 48:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(S.a,{open:a,onClose:c,className:"dialogbox edit-profile"},r.a.createElement(q.a,null,"Edit profile"),r.a.createElement(U.a,null,r.a.createElement("div",{className:"update-banner",style:{backgroundImage:"url(".concat(G,")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}},r.a.createElement("div",{className:"layer"}),r.a.createElement("input",{accept:"image/jpeg,image/png,image/webp,image/gif,video/mp4,video/quicktime,video/webm",hidden:!0,id:"icon-button-edit-banner",type:"file",onChange:function(e){var t=e.target.files[0];J(t),V(URL.createObjectURL(t))}}),r.a.createElement("label",{htmlFor:"icon-button-edit-banner"},r.a.createElement(k.a,{className:"upload-img","aria-label":"upload image",component:"span"},r.a.createElement(Ve.a,null)))),r.a.createElement("div",{className:"edit-profile-info"},r.a.createElement("div",{className:"update-profile-pic",style:{backgroundImage:"url(".concat(R,")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}},r.a.createElement("div",{className:"layer"}),r.a.createElement("input",{accept:"image/jpeg,image/png,image/webp,image/gif,video/mp4,video/quicktime,video/webm",hidden:!0,id:"icon-button-edit",type:"file",onChange:function(e){var t=e.target.files[0];M(t),T(URL.createObjectURL(t))}}),r.a.createElement("label",{htmlFor:"icon-button-edit"},r.a.createElement(k.a,{className:"upload-img","aria-label":"upload image",component:"span"},r.a.createElement(Ve.a,null)))),r.a.createElement(L.a,{type:"text",label:"Name",onChange:function(e){return m(e.target.value)},value:i,className:"text-field"}),r.a.createElement(L.a,{type:"text",label:"Bio",onChange:function(e){return E(e.target.value)},value:b,multiline:!0,className:"text-field"}),r.a.createElement(L.a,{type:"text",label:"Location",onChange:function(e){return N(e.target.value)},value:v,className:"text-field"}),r.a.createElement(L.a,{type:"text",label:"Website",onChange:function(e){return x(e.target.value)},value:w,className:"text-field"}))),r.a.createElement(F.a,{className:"delete-action"},r.a.createElement(C.a,{onClick:c,className:"btn cancel"},"Cancel"),r.a.createElement(C.a,{className:"btn save",onClick:H},"Save")))},Ke=function(e){var t=e.loggedUser,a=e.userName,c=e.firebase,o=Object(n.useState)(!1),s=Object(O.a)(o,2),l=s[0],i=s[1],m=Object(n.useState)("Following"),f=Object(O.a)(m,2),p=f[0],b=f[1];Object(n.useEffect)((function(){return t&&a&&function(){var e=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.firestore.collection("following").doc(t).get();case 2:(n=e.sent).exists&&n.data().listFollowing.includes(a)&&i(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){i(!1)}}),[t,a,c.firestore]);var E=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,c.firestore.collection("following").doc(t).get();case 3:if(!e.sent.exists){e.next=9;break}return e.next=7,c.firestore.collection("following").doc(t).update({listFollowing:c.FieldValue.arrayUnion(a)});case 7:e.next=11;break;case 9:return e.next=11,c.firestore.collection("following").doc(t).set({listFollowing:c.FieldValue.arrayUnion(a)});case 11:return e.next=13,c.firestore.collection("users").doc(t).update({following:c.FieldValue.increment(1)});case 13:return e.next=15,c.firestore.collection("users").doc(a).update({followers:c.FieldValue.increment(1)});case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!1),e.next=3,c.firestore.collection("following").doc(t).update({listFollowing:c.FieldValue.arrayRemove(a)});case 3:return e.next=5,c.firestore.collection("users").doc(t).update({following:c.FieldValue.increment(-1)});case 5:return e.next=7,c.firestore.collection("users").doc(a).update({followers:c.FieldValue.increment(-1)});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,l?r.a.createElement(C.a,{onClick:g,variant:"contained",className:"unfollow-button",onMouseEnter:function(){return b("Unfollow")},onMouseLeave:function(){return b("Following")}},p):r.a.createElement(C.a,{onClick:E,variant:"contained",className:"follow-button"},"Follow"))},Ye=a(245),Je=a.n(Ye),He=a(244),qe=a.n(He),Ze=a(243),Qe=a.n(Ze),Xe=Object(Ue.compose)(l.g,h)((function(e){var t=e.firebase,a=e.userName,c=e.loggedUser,o=e.history,s=Object(n.useState)({}),l=Object(O.a)(s,2),i=l[0],u=l[1],m=Object(n.useState)(!1),d=Object(O.a)(m,2),f=d[0],b=d[1],E=Object(n.useState)(!1),g=Object(O.a)(E,2),h=g[0],v=g[1];return Object(n.useEffect)((function(){var e=t.firestore.collection("users").doc(a).onSnapshot((function(e){if(!e.exists)return o.push("/");u(e.data())}));return function(){e()}}),[a,o,t.firestore]),Object(n.useEffect)((function(){return a===c?b(!0):a!==c?b(!1):void 0}),[c,a]),r.a.createElement(r.a.Fragment,null,0===Object.keys(i).length&&i.constructor===Object?r.a.createElement(R.a,{display:"flex",justifyContent:"center"},r.a.createElement(oe.a,{size:30})):r.a.createElement("div",{className:"user-banner"},r.a.createElement("div",{className:"banner-img",style:{backgroundImage:"url(".concat(i.userBanner,")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),r.a.createElement("div",{className:"banner-info"},r.a.createElement("div",{className:"banner-profile-pic-container"},r.a.createElement("div",{style:{backgroundImage:"url(".concat(i.userImage,")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),r.a.createElement("img",{src:i.userImage,alt:"".concat(i.userName)})),r.a.createElement(I.a,{variant:"body2",className:"user-displayedName"},i.displayedName),r.a.createElement(I.a,{variant:"body2",className:"user-userName"},"@",i.userName),r.a.createElement(I.a,{variant:"body2",className:"user-bio"},i.bio),r.a.createElement(R.a,{display:"flex",alignItems:"center",mt:1,flexWrap:"wrap"},r.a.createElement(I.a,{variant:"body2",className:"user-location"},r.a.createElement(Qe.a,null)," ",i.location),r.a.createElement(I.a,{variant:"body2"},r.a.createElement("a",{href:"https://".concat(i.website),target:"_blank",rel:"noopener noreferrer",className:"user-website"},r.a.createElement(qe.a,null)," ",i.website)),r.a.createElement(I.a,{variant:"body2",className:"user-joined"},r.a.createElement(Je.a,{fontSize:"small"})," Joined ",p()(i.createdAt).format("MMMM YYYY"))),r.a.createElement(R.a,{display:"flex",alignItems:"center",mt:1},r.a.createElement(I.a,{variant:"body2",className:"user-following"},r.a.createElement("span",null,i.following)," Following"),r.a.createElement(I.a,{variant:"body2",className:"user-followers"},r.a.createElement("span",null,i.followers)," Followers")),f?r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{onClick:function(){return v(!0)},variant:"contained",className:"edit-profile-button"},"Edit profile"),r.a.createElement(We,{open:h,handleClose:function(){v(!1)},user:i,firebase:t})):r.a.createElement("div",{className:"banner-action-button"},r.a.createElement(Ke,{loggedUser:c,userName:a,firebase:t}),r.a.createElement(Be,{loggedUser:c,userName:a,firebase:t})))))})),$e=Le((function(e){return!!e}))((function(e){var t=Object(n.useContext)(w).state;return r.a.createElement("div",null,r.a.createElement(Xe,{userName:e.match.params.userName,loggedUser:t.user.credentials.userName}),r.a.createElement(se,{singleUserPosts:e.match.params.userName}))})),et=a(246),tt=a.n(et),at=h((function(e){var t=e.firebase;return r.a.createElement(k.a,{color:"primary",onClick:t.doSignOut},r.a.createElement(tt.a,null))}));var nt=a(544),rt=a(247),ct=a.n(rt),ot=h((function(e){var t=e.firebase,a=Object(n.useState)(""),c=Object(O.a)(a,2),o=c[0],l=c[1],i=Object(n.useState)([]),m=Object(O.a)(i,2),f=m[0],p=m[1],b=Object(n.useState)(!1),E=Object(O.a)(b,2),g=E[0],h=E[1],v=function(e,t){var a=Object(n.useState)(e),r=Object(O.a)(a,2),c=r[0],o=r[1];return Object(n.useEffect)((function(){var a=setTimeout((function(){o(e)}),t);return function(){clearTimeout(a)}}),[e]),c}(o,500),N=Object(n.useRef)(null);Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.toLowerCase(),n=[],e.next=4,t.firestore.collection("users").orderBy("userName_lowercase").startAt(a).endAt(a+"\uf8ff").get();case 4:e.sent.forEach((function(e){n.push(e.data())})),p(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();o?e():p([])}),[v]),Object(n.useEffect)((function(){return document.addEventListener("mousedown",y,!1),function(){document.removeEventListener("mousedown",y,!1)}}));var y=function(e){if(!N.current.contains(e.target))return h(!1)};return r.a.createElement("div",{className:"search-user-container",ref:N},r.a.createElement(L.a,{className:"search-input ".concat(g?"search-input-focused":""),value:o,onChange:function(e){l(e.target.value)},InputProps:{startAdornment:r.a.createElement(nt.a,{position:"start"},r.a.createElement(ct.a,null))},onFocus:function(){return h(!0)},placeholder:"Search a user"}),o?r.a.createElement(k.a,{className:"search-delete-search",onClick:function(){return l("")}},r.a.createElement(fe.a,null)):null,f.length>0&&g?r.a.createElement("div",{className:"search-user-result"},f.map((function(e,t){return r.a.createElement(s.b,{to:"/user/".concat(e.userName),onClick:function(){return l(""),void p([])},key:t},r.a.createElement(R.a,{className:"search-user-info",display:"flex",alignItems:"center"},r.a.createElement("img",{src:e.userImage,alt:e.userName}),r.a.createElement("div",null,r.a.createElement(I.a,{className:"user-displayedName"},e.displayedName),r.a.createElement(I.a,{className:"user-userName"},"@",e.userName))))}))):null)})),st=a(545),lt=a(248),it=a.n(lt),ut=a(249),mt=a.n(ut),dt=a(134),ft=a.n(dt),pt=function(){var e,t=Object(n.useContext)(w).state,a=t.user.notifications;return e=a&&a.length>0&&a.filter((function(e){return!1===e.read})).length>0?r.a.createElement(st.a,{badgeContent:a.filter((function(e){return!1===e.read})).length,className:"notification-badge"},r.a.createElement(ft.a,null)):r.a.createElement(ft.a,null),r.a.createElement("nav",{className:"nav"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(s.c,{exact:!0,activeClassName:"active-menu",to:"/"},r.a.createElement(k.a,{color:"primary"},r.a.createElement(it.a,null)))),r.a.createElement("li",null,r.a.createElement(s.c,{exact:!0,activeClassName:"active-menu",to:"/user/".concat(t.user.credentials.userName)},r.a.createElement(k.a,{color:"primary"},r.a.createElement(mt.a,null)))),r.a.createElement("li",null,r.a.createElement(s.c,{exact:!0,activeClassName:"active-menu",to:"/notifications"},r.a.createElement(k.a,{color:"primary"},e))),r.a.createElement("li",null,r.a.createElement(s.c,{activeClassName:"active-menu",to:"/messages"},r.a.createElement(k.a,{color:"primary"},r.a.createElement(_e.a,null)))),r.a.createElement("li",null,r.a.createElement(at,null)),r.a.createElement("li",null,r.a.createElement(ot,null))))},bt=function(){return r.a.createElement("nav",{className:"nav nav-not-logged"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(s.b,{to:"/signup"},r.a.createElement(I.a,{variant:"body1",component:"span"},"Sign Up"))),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/signin"},r.a.createElement(I.a,{variant:"body1",component:"span"},"Log in")))))},Et=function(){return r.a.createElement(Se.Consumer,null,(function(e){return null!==e?r.a.createElement(pt,null):r.a.createElement(bt,null)}))},gt=a(86),ht={username:"",email:"",passwordOne:"",passwordTwo:"",error:null},vt=h((function(e){var t=e.firebase,a=Object(n.useState)(ht),c=Object(O.a)(a,2),o=c[0],s=c[1],l=Object(n.useState)(!1),i=Object(O.a)(l,2),m=i[0],f=i[1],p=function(){var e=Object(d.a)(u.a.mark((function e(a){var n,r,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),n=o.username,r=o.email,c=o.passwordOne,f(!0),e.next=5,t.firestore.collection("users").doc("".concat(n)).get();case 5:if(e.sent.exists){e.next=21;break}return e.prev=7,e.next=10,t.doCreateUserWithEmailAndPassword(r,c);case 10:return l=e.sent,e.next=13,b(r,n,l.user.uid);case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(7),f(!1),s((function(t){return Object(N.a)(Object(N.a)({},t),{},{error:e.t0})}));case 19:e.next=23;break;case 21:f(!1),s((function(e){return Object(N.a)(Object(N.a)({},e),{},{error:{message:"Username already taken"}})}));case 23:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(d.a)(u.a.mark((function e(a,n,r){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.toLowerCase(),e.next=3,t.firestore.collection("users").doc(n).set({bio:"",createdAt:(new Date).toISOString(),email:a,userName:n,userName_lowercase:c,displayedName:n,displayedName_lowercase:c,userImage:"https://firebasestorage.googleapis.com/v0/b/".concat("social-app-react-hook.appspot.com","/o/no-img.png?alt=media"),userBanner:"",location:"",userId:r,website:"",followers:0,following:0});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),E=function(e){s(Object(N.a)(Object(N.a)({},o),{},Object(gt.a)({},e.target.name,e.target.value)))},g=o.passwordOne!==o.passwordTwo||""===o.passwordOne||""===o.email||""===o.username;return r.a.createElement("form",{onSubmit:p},r.a.createElement(L.a,{className:"form-input-container",name:"username",value:o.username,onChange:E,type:"text",label:"Username"}),r.a.createElement(L.a,{className:"form-input-container",name:"email",value:o.email,onChange:E,type:"text",label:"Email Address"}),r.a.createElement(L.a,{className:"form-input-container",name:"passwordOne",value:o.passwordOne,onChange:E,type:"password",label:"Password"}),r.a.createElement(L.a,{className:"form-input-container",name:"passwordTwo",value:o.passwordTwo,onChange:E,type:"password",label:"Confirm Password"}),r.a.createElement(C.a,{className:"form-button",type:"submit",variant:"contained",disabled:g},m?r.a.createElement(oe.a,{size:30}):"Sign Up"),o.error&&r.a.createElement(I.a,{variant:"body2",className:"form-error"},o.error.message))})),Ot=function(){var e=Object(n.useContext)(w).state,t=Object(n.useState)(null),a=Object(O.a)(t,2),c=a[0],o=a[1],i=e.user,u=i.authenticated,m=i.loading;return Object(n.useEffect)((function(){o(!!u)}),[u]),r.a.createElement(r.a.Fragment,null,m?r.a.createElement(R.a,{display:"flex",justifyContent:"center"},r.a.createElement(oe.a,{size:50})):c?r.a.createElement(l.a,{to:"/"}):r.a.createElement(R.a,{className:"form-container"},r.a.createElement(I.a,{variant:"h4",component:"h1"},"Create an account"),r.a.createElement(vt,null),r.a.createElement(s.b,{to:"/signin",className:"form-link"},r.a.createElement(I.a,{variant:"body1",component:"span"},"Log In"))))},Nt={email:"",password:"",error:null},yt=h((function(e){var t=e.firebase,a=Object(n.useState)(Nt),c=Object(O.a)(a,2),o=c[0],s=c[1],l=Object(n.useState)(!1),i=Object(O.a)(l,2),m=i[0],f=i[1],p=function(){var e=Object(d.a)(u.a.mark((function e(a){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),n=o.email,r=o.password,f(!0),e.prev=3,e.next=6,t.doSignInWithEmailAndPassword(n,r);case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),f(!1),s((function(t){return Object(N.a)(Object(N.a)({},t),{},{error:e.t0})}));case 12:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}(),b=function(e){s(Object(N.a)(Object(N.a)({},o),{},Object(gt.a)({},e.target.name,e.target.value)))},E=""===o.password||""===o.email;return r.a.createElement("form",{onSubmit:p},r.a.createElement(L.a,{className:"form-input-container",name:"email",value:o.email,onChange:b,type:"text",label:"Email Address"}),r.a.createElement(L.a,{className:"form-input-container",name:"password",value:o.password,onChange:b,type:"password",label:"Password"}),r.a.createElement(C.a,{className:"form-button",type:"submit",variant:"contained",disabled:E},m?r.a.createElement(oe.a,{size:30}):"Log In"),o.error&&r.a.createElement(I.a,{variant:"body2",className:"form-error"},o.error.message))})),jt=function(){var e=Object(n.useContext)(w).state,t=Object(n.useState)(null),a=Object(O.a)(t,2),c=a[0],o=a[1],i=e.user,u=i.authenticated,m=i.loading;return Object(n.useEffect)((function(){o(!!u)}),[u]),r.a.createElement(r.a.Fragment,null,m?r.a.createElement(R.a,{display:"flex",justifyContent:"center"},r.a.createElement(oe.a,{size:50})):c?r.a.createElement(l.a,{to:"/"}):r.a.createElement(R.a,{className:"form-container"},r.a.createElement(I.a,{variant:"h4",component:"h1"},"Log in"),r.a.createElement(yt,null),r.a.createElement(s.b,{to:"/signup",className:"form-link"},r.a.createElement(I.a,{variant:"body1",component:"span"},"Sign Up"))))},wt=Le((function(e){return!!e}))(h((function(e){var t=e.firebase,a=Object(n.useContext)(w).state.user.notifications,c=Object(n.useState)([]),o=Object(O.a)(c,2),l=o[0],i=o[1];Object(n.useEffect)((function(){a&&a.length>0&&a.forEach(function(){var e=Object(d.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.firestore.collection("users").where("userName","==",a.sender).get();case 2:e.sent.forEach((function(e){i((function(t){return!t.filter((function(t){return t.userName===e.data().userName})).length>0?[].concat(Object(m.a)(t),[e.data()]):Object(m.a)(t)}))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[a,t.firestore]);var f=function(){var e=Object(d.a)(u.a.mark((function e(a,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return e.next=3,t.firestore.collection("notifications").doc(a).update({read:!0});case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"notifications-container"},r.a.createElement(I.a,{component:"h1"},"Notifications"),null!==a?r.a.createElement(r.a.Fragment,null,a.length>0&&l&&l.length>0?r.a.createElement(r.a.Fragment,null,a.map((function(e,t){var a="like"===e.type?"liked":"commented on",n=l.filter((function(t){return t.userName===e.sender})),c=n.length>0?n[0].userImage:null,o=l.filter((function(t){return t.userName===e.sender})).length>0?n[0].userName:null,i=e.read?"notification-read":"notification-not-read";return r.a.createElement(R.a,{className:"notification-item ".concat(i),key:t,onMouseEnter:function(){return f(e.id,e.read)}},r.a.createElement(s.b,{to:"/".concat(e.recipient,"/post/").concat(e.postId),className:"notification-global-link"}),r.a.createElement(R.a,{display:"flex",alignItems:"flex-start"},"like"===e.type?r.a.createElement(z.a,null):r.a.createElement(T.a,{className:"comment-icon"},r.a.createElement("path",{d:"M14.046 2.242l-4.148-.01h-.002c-4.374 0-7.8 3.427-7.8 7.802 0 4.098 3.186 7.206 7.465 7.37v3.828c0 .108.044.286.12.403.142.225.384.347.632.347.138 0 .277-.038.402-.118.264-.168 6.473-4.14 8.088-5.506 1.902-1.61 3.04-3.97 3.043-6.312v-.017c-.006-4.367-3.43-7.787-7.8-7.788zm3.787 12.972c-1.134.96-4.862 3.405-6.772 4.643V16.67c0-.414-.335-.75-.75-.75h-.396c-3.66 0-6.318-2.476-6.318-5.886 0-3.534 2.768-6.302 6.3-6.302l4.147.01h.002c3.532 0 6.3 2.766 6.302 6.296-.003 1.91-.942 3.844-2.514 5.176z"})),r.a.createElement(R.a,null,r.a.createElement(s.b,{to:"/user/".concat(o),className:"notification-user-link"},r.a.createElement(P.a,{alt:e.sender,src:c,className:"avatar"})),r.a.createElement(I.a,{component:"p",variant:"body2",className:"notifciation-user-infos"},r.a.createElement(s.b,{to:"/user/".concat(o),className:"notification-user-link notification-userName"},e.sender)," ".concat(a," your post")))))}))):r.a.createElement(R.a,{display:"flex",justifyContent:"center"},r.a.createElement(oe.a,{size:30}))):r.a.createElement(I.a,{className:"no-notificiations"},"No notifications yet"))}))),xt=function(e){var t=e.loggedUserId,a=e.firebase,c=e.roomOpen,o=e.setRoomOpen,l=Object(n.useState)([]),i=Object(O.a)(l,2),f=i[0],p=i[1],b=Object(n.useState)([]),E=Object(O.a)(b,2),g=E[0],h=E[1];return Object(n.useEffect)((function(){t&&function(){var e=Object(d.a)(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.firestore.collection("rooms").orderBy("lastMessage","desc").where("availableUsers","array-contains",t).get();case 2:n=e.sent,r=[],n.forEach((function(e){r.push(e.data())})),p(r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t]),Object(n.useEffect)((function(){f.length>0&&f.map(function(){var e=Object(d.a)(u.a.mark((function e(n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.availableUsers.filter((function(e){return e!==t}))[0],e.next=3,a.firestore.collection("users").where("userId","==",r).get();case 3:e.sent.forEach((function(e){var t=n.roomKey;h((function(a){return[].concat(Object(m.a)(a),[Object(N.a)({roomKey:t},e.data())])}))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[f]),r.a.createElement("div",{className:"private-message-list"},g&&g.length>0?g.map((function(e,t){return r.a.createElement(R.a,{display:"flex",alignItems:"center",key:t,className:"single-message-info ".concat(c===e.roomKey?"active-room":""),onClick:function(){o("".concat(e.roomKey))}},r.a.createElement(s.b,{to:"/user/".concat(e.userName)},r.a.createElement(P.a,{alt:e.userName,src:e.userImage,className:"avatar"})),r.a.createElement(R.a,{ml:2,display:"flex",alignItems:"center"},r.a.createElement(I.a,{variant:"h6",component:"p",className:"dm-displayed-name"},e.displayedName),r.a.createElement(I.a,{variant:"body2",component:"p",className:"dm-username"},"@",e.userName)))})):null)},It=a(250),kt=a.n(It),Ct=function(e){var t=e.firebase,a=e.roomOpen,c=e.roomUserNotLogged,o=e.loggedUserId,s=Object(n.useState)(""),l=Object(O.a)(s,2),i=l[0],m=l[1],f=Object(n.useState)(!1),p=Object(O.a)(f,2),b=p[0],E=p[1],g=Object(n.useState)(""),h=Object(O.a)(g,2),v=h[0],N=h[1],y=Object(n.useState)(!1),j=Object(O.a)(y,2),w=j[0],x=j[1],I=function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.firestore.collection("messages").doc(a).collection(a).add({content:i,contentImg:n,createdAt:(new Date).toISOString(),recipientId:c.userId,senderId:o});case 2:return e.next=4,t.firestore.collection("rooms").where("roomKey","==",a).get();case 4:e.sent.forEach(function(){var e=Object(d.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.firestore.collection("rooms").doc(a.id).update({lastMessage:(new Date).toISOString()});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m(""),N(""),x(!1);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){if(e.preventDefault(),x(!0),v){var n=v.name.split(".").pop(),r="".concat(Object(le.a)(),".").concat(n);t.storage.ref("".concat(a,"/").concat(r)).put(v).then(function(){var e=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.ref.getDownloadURL();case 2:a=e.sent,I(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}else I("")};return r.a.createElement("form",{onSubmit:C,className:"private-message-form ".concat(v?"withImg":""," ").concat(w?"uploading-message":"")},v?r.a.createElement("div",{className:"img-upload-preview"},r.a.createElement(k.a,{className:"delete-img-message",onClick:function(){return N("")},"aria-label":"delete picture",component:"button"},r.a.createElement(fe.a,null)),r.a.createElement("img",{src:URL.createObjectURL(v),alt:""})):r.a.createElement(me,{chosenGif:null,handleUploadFile:function(e){return N(e.target.files[0])},multiple:!1}),r.a.createElement("div",{className:"text-field-container"},r.a.createElement(L.a,{type:"text",placeholder:"Start a new message",value:i,multiline:!0,onChange:function(e){return m(e.target.value)},className:"message-text-field ".concat(b?"message-text-field-focused":""),onFocus:function(){return E(!0)},onBlur:function(){return E(!1)},disabled:w,onKeyPress:function(e){return function(e){"Enter"===e.key&&(e.preventDefault(),C(e))}(e)}}),r.a.createElement(k.a,{disabled:""===i&&""===v||w,type:"submit",variant:"contained",className:"send-message-button"},r.a.createElement(kt.a,null))))},St=function(e){var t=e.roomOpen,a=e.firebase,c=e.loggedUserId,o=e.roomUserNotLogged,l=Object(n.useState)([]),i=Object(O.a)(l,2),u=i[0],m=i[1],d=function(){var e=Object(n.useRef)();return Object(n.useEffect)((function(){return e.current.scrollIntoView()})),r.a.createElement("div",{ref:e})};return Object(n.useEffect)((function(){var e=a.firestore.collection("messages").doc(t).collection(t).orderBy("createdAt","asc").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(e.data())})),m(t)}));return function(){e()}}),[t,a.firestore]),r.a.createElement(R.a,{className:"list-messages"},u&&u.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,u.map((function(e,t){var a=c===e.recipientId?o.userImage:null,n=c===e.recipientId?o.userName:null,l=c===e.senderId?"sender":"recipient",i=e.contentImg?" withImg":"";return r.a.createElement("div",{className:"single-message",key:t},a&&n?r.a.createElement(R.a,{display:"flex",alignItems:"center"},r.a.createElement(s.b,{to:"/user/".concat(n)},r.a.createElement(P.a,{alt:n,src:a,className:"avatar"})),r.a.createElement("div",{className:"".concat(l)},r.a.createElement(I.a,{component:"span",variant:"body2"},e.content))):r.a.createElement("div",{className:"".concat(l," ").concat(i," ")},e.contentImg?r.a.createElement("img",{src:e.contentImg,alt:""}):null,e.content?r.a.createElement(I.a,{component:"span",variant:"body2"},e.content):null),r.a.createElement(I.a,{component:"div",variant:"body2",className:"".concat(l," message-date")},p()(e.createdAt).format("H:mm A")))})),r.a.createElement(d,null))):null,r.a.createElement(Ct,{firebase:a,roomOpen:t,roomUserNotLogged:o,loggedUserId:c}))},Ft=Le((function(e){return!!e}))(h(Object(l.g)((function(e){var t=e.firebase,a=e.match,c=e.history,o=Object(n.useContext)(w).state.user.credentials.userId,s=Object(n.useState)(""),l=Object(O.a)(s,2),i=l[0],u=l[1],m=Object(n.useState)({}),d=Object(O.a)(m,2),f=d[0],p=d[1];return Object(n.useEffect)((function(){if(a.params.roomId&&o&&a.params.roomId.includes(o)){u(a.params.roomId);var e=a.params.roomId.split("-").filter((function(e){return e!==o}))[0];t.firestore.collection("users").where("userId","==",e).get().then((function(e){e.forEach((function(e){p(e.data())}))}))}}),[a,o,t.firestore]),Object(n.useEffect)((function(){i&&c.push("".concat("/messages","/").concat(i))}),[i,c]),r.a.createElement(R.a,{display:"flex",alignItems:"align-start"},r.a.createElement(xt,{loggedUserId:o,firebase:t,roomOpen:i,setRoomOpen:u}),i&&""!==i?r.a.createElement(St,{roomOpen:i,firebase:t,loggedUserId:o,roomUserNotLogged:f}):null)})))),Ut=a(546),Lt=Fe((function(){return r.a.createElement(s.a,null,r.a.createElement(x,null,r.a.createElement(Et,null),r.a.createElement(Ut.a,{maxWidth:"lg"},r.a.createElement(l.d,null,r.a.createElement(l.b,{exact:!0,path:"/",component:Pe}),r.a.createElement(l.b,{exact:!0,path:"/signup",component:Ot}),r.a.createElement(l.b,{exact:!0,path:"/signin",component:jt}),r.a.createElement(l.b,{exact:!0,path:"/user/:userName",component:$e}),r.a.createElement(l.b,{exact:!0,path:"/:userName/post/:postId",component:ze}),r.a.createElement(l.b,{exact:!0,path:"/notifications",component:wt}),r.a.createElement(l.b,{exact:!0,path:"/messages",component:Ft}),r.a.createElement(l.b,{exact:!0,path:"".concat("/messages","/:roomId"),component:Ft}),r.a.createElement(l.b,{render:function(){return r.a.createElement(l.a,{to:"/"})}})))))})),Pt=(a(490),a(251)),Rt=a(92),Tt=a.n(Rt),At=(a(491),a(493),a(496),a(499),{apiKey:"AIzaSyCKy9swsWrniIDceVScFDoIsTCttFyFcdM",authDomain:"social-app-react-hook.firebaseapp.com",databaseURL:"https://social-app-react-hook.firebaseio.com",projectId:"social-app-react-hook",storageBucket:"social-app-react-hook.appspot.com",messagingSenderId:"727948993576",appId:"1:727948993576:web:e7327e5d6295421769411d",measurementId:"G-QNMT30RRXZ"}),Dt=function e(){var t=this;Object(Pt.a)(this,e),this.doCreateUserWithEmailAndPassword=function(e,a){return t.auth.createUserWithEmailAndPassword(e,a)},this.doSignInWithEmailAndPassword=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.doSignOut=function(){return t.auth.signOut()},this.doPasswordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.doPasswordUpdate=function(e){return t.auth.currentUser.updatePassword(e)},Tt.a.initializeApp(At),this.auth=Tt.a.auth(),this.firestore=Tt.a.firestore(),this.storage=Tt.a.storage(),this.FieldValue=Tt.a.firestore.FieldValue};o.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(v.Provider,{value:new Dt},r.a.createElement(Lt,null))),document.getElementById("root"))}},[[271,1,2]]]);
//# sourceMappingURL=main.f5898aa1.chunk.js.map